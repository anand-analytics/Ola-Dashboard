<?xml version="1.0" encoding="UTF-8"?><sqlb_project><db path="Ola.db" readonly="0" foreign_keys="1" case_sensitive_like="0" temp_store="0" wal_autocheckpoint="1000" synchronous="2"/><attached/><window><main_tabs open="structure browser pragmas query" current="3"/></window><tab_structure><column_width id="0" width="300"/><column_width id="1" width="0"/><column_width id="2" width="100"/><column_width id="3" width="3113"/><column_width id="4" width="0"/><expanded_item id="0" parent="1"/><expanded_item id="1" parent="1"/><expanded_item id="2" parent="1"/><expanded_item id="3" parent="1"/></tab_structure><tab_browse><table title="Bookings_July" custom_title="0" dock_id="1" table="4,13:mainBookings_July"/><dock_state state="000000ff00000000fd00000001000000020000043c000002b4fc0100000001fb000000160064006f0063006b00420072006f007700730065003101000000000000043c0000015c00ffffff0000043c0000000000000004000000040000000800000008fc00000000"/><default_encoding codec=""/><browse_table_settings><table schema="main" name="Bookings_July" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="156"/><column index="2" value="70"/><column index="3" value="109"/><column index="4" value="163"/><column index="5" value="82"/><column index="6" value="93"/><column index="7" value="163"/><column index="8" value="163"/><column index="9" value="44"/><column index="10" value="44"/><column index="11" value="300"/><column index="12" value="280"/><column index="13" value="109"/><column index="14" value="157"/><column index="15" value="91"/><column index="16" value="106"/><column index="17" value="88"/><column index="18" value="92"/><column index="19" value="105"/><column index="20" value="300"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table></browse_table_settings></tab_browse><tab_sql><sql name="OG">-- 1. Retrieve all successful bookings

create view Successfull_Bookings as
SELECT * from Bookings_July
WHERE Booking_Status='Success'

-- 2. Find the average ride distance for each vehicle type

CREATE VIEW ride_distance_for_each_vehicle as
SELECT Vehicle_Type as type,
round(avg(Ride_Distance),2) as Average
FROM Bookings_July
group by Vehicle_Type

--3. Get the total number of cancelled rides by customers
CREATE VIEW cancelled_rides_by_customers as
SELECT 
	count(Booking_Status) as &quot;Rides Cancelled by Customer&quot;
FROM
	Bookings_July
WHERE
	Booking_Status = 'Canceled by Customer'
	-- 4. List the top 5 customers who booked the highest number of rides
CREATE VIEW top_5_customers as
SELECT
	Customer_ID as Customer,
	count(Booking_Status) as Count
FROM
	Bookings_July
group by 
	Customer_ID
ORDER by Count DESC
LIMIT 5

-- 5. Get the number of rides cancelled by drivers due to personal and car-related issues
CREATE VIEW Canceled_by_riders_P_C_Issues as
SELECT 
	count(Canceled_Rides_by_Driver) as &quot;Cancelled Rides&quot;
FROM
	Bookings_July
WHERE
	Canceled_Rides_by_Driver = 'Personal &amp; Car related issue'

	-- 6. Find the maximum and minimum driver ratings for Prime Sedan bookings
CREATE VIEW Max_Min_DriverRatings as
SELECT 
	max(Driver_Ratings) AS Max_Rating,
	min(Driver_Ratings) as Min_Rating
FROM Bookings_July
WHERE
	Vehicle_Type = 'Prime Sedan'
	
-- 7. Retrieve all rides where payment was made using UPI

CREATE VIEW UPI_Payment as
SELECT *
FROM 
	Bookings_July
WHERE
	Payment_Method = 'UPI'
	
-- 8. Find the average customer rating per vehicle type

CREATE view Average_CRating_By_Vehicle_Type as
SELECT 
	Vehicle_Type,
	round(avg(Customer_Rating),2) as Average
FROM Bookings_July
group by
	Vehicle_Type
	
-- 9. Calculate the total booking value of rides completed successfully

create view total_succesffull_ride_value as
SELECT
	sum(Booking_Value) as total_successfull_value
FROM Bookings_July
WHERE
	Booking_Status = 'Success'

	-- 10. List all incomplete rides along with the reason
create view incomplete_ride_reason as
SELECT
	Booking_ID,
	Incomplete_Rides_Reason as Reason
FROM
	Bookings_July
WHERE
	Incomplete_Rides = 'Yes'
	




</sql><sql name="Views*">-- 1. Retrieve all successful bookings

SELECT * FROM Successfull_Bookings

-- 2. Find the average ride distance for each vehicle type

SELECT * FROM ride_distance_for_each_vehicle

--3. Get the total number of cancelled rides by customers

SELECT * FROM cancelled_rides_by_customers

-- 4. List the top 5 customers who booked the highest number of rides

SELECT * FROM top_5_customers

-- 5. Get the number of rides cancelled by drivers due to personal and car-related issues

SELECT * FROM Canceled_by_riders_P_C_Issues

-- 6. Find the maximum and minimum driver ratings for Prime Sedan bookings

SELECT * FROM Max_Min_DriverRatings

-- 7. Retrieve all rides where payment was made using UPI

SELECT * FROM UPI_Payment

-- 8. Find the average customer rating per vehicle type

SELECT * FROM Average_CRating_By_Vehicle_Type

-- 9. Calculate the total booking value of rides completed successfully

SELECT * FROM total_succesffull_ride_value

-- 10. List all incomplete rides along with the reason

SELECT * FROM incomplete_ride_reason
</sql><sql name="1">-- 1. Retrieve all successful bookings

create view Successfull_Bookings as
SELECT * from Bookings_July
WHERE Booking_Status='Success'
</sql><sql name="2">-- 2. Find the average ride distance for each vehicle type

CREATE VIEW ride_distance_for_each_vehicle as
SELECT Vehicle_Type as type,
round(avg(Ride_Distance),2) as Average
FROM Bookings_July
group by Vehicle_Type</sql><sql name="3">--3. Get the total number of cancelled rides by customers
CREATE VIEW cancelled_rides_by_customers as
SELECT 
	count(Booking_Status) as &quot;Rides Cancelled by Customer&quot;
FROM
	Bookings_July
WHERE
	Booking_Status = 'Canceled by Customer'</sql><sql name="4">-- 4. List the top 5 customers who booked the highest number of rides
CREATE VIEW top_5_customers as
SELECT
	Customer_ID as Customer,
	count(Booking_Status) as Count
FROM
	Bookings_July
group by 
	Customer_ID
ORDER by Count DESC
LIMIT 5
</sql><sql name="5">-- 5. Get the number of rides cancelled by drivers due to personal and car-related issues
CREATE VIEW Canceled_by_riders_P_C_Issues as
SELECT 
	count(Canceled_Rides_by_Driver) as &quot;Cancelled Rides&quot;
FROM
	Bookings_July
WHERE
	Canceled_Rides_by_Driver = 'Personal &amp; Car related issue'





</sql><sql name="6">-- 6. Find the maximum and minimum driver ratings for Prime Sedan bookings
CREATE VIEW Max_Min_DriverRatings as
SELECT 
	max(Driver_Ratings) AS Max_Rating,
	min(Driver_Ratings) as Min_Rating
FROM Bookings_July
WHERE
	Vehicle_Type = 'Prime Sedan'</sql><sql name="7">-- 7. Retrieve all rides where payment was made using UPI
CREATE VIEW UPI_Payment as
SELECT *
FROM 
	Bookings_July
WHERE
	Payment_Method = 'UPI'
</sql><sql name="8">-- 8. Find the average customer rating per vehicle type
CREATE view Average_CRating_By_Vehicle_Type as
SELECT 
	Vehicle_Type,
	round(avg(Customer_Rating),2) as Average
FROM Bookings_July
group by
	Vehicle_Type</sql><sql name="9">-- 9. Calculate the total booking value of rides completed successfully
create view total_succesffull_ride_value as
SELECT
	sum(Booking_Value) as total_successfull_value
FROM Bookings_July
WHERE
	Booking_Status = 'Success'</sql><sql name="10">-- 10. List all incomplete rides along with the reason
create view incomplete_ride_reason as
SELECT
	Booking_ID,
	Incomplete_Rides_Reason as Reason
FROM
	Bookings_July
WHERE
	Incomplete_Rides = 'Yes'</sql><current_tab id="0"/></tab_sql></sqlb_project>
